# 门店桥接电脑配置与网络要求（2026-02-24）

本文档说明：**连接全部 POS 硬件的那台电脑**（桥接机）的硬件配置、网络配置、是否必须接显示器，以及显示器对远程排障的作用。

---

## 一、桥接电脑的硬件配置要求

### 1.1 定位与负载

桥接机只做两件事：

1. **与 GCP 后端通信**：拉取/接收打印任务、开钱箱、KDS 更新等（HTTPS 或 WebSocket，负载很轻）。
2. **与本地硬件通信**：通过串口、并口、USB 把指令发给打印机、钱箱、KDS 等。

不跑数据库、不跑 POS 前端，**对算力要求不高**，更看重**接口数量、稳定性、驱动兼容性**。

### 1.2 推荐配置（按规模）

| 项目 | 最小配置（单店 1～2 台打印机 + 钱箱 + 可选 KDS） | 建议配置（多台打印机 + 多档口 KDS + 扫码枪等） |
|------|--------------------------------------------------|------------------------------------------------|
| **CPU** | 双核 x86 或 ARM 四核（如树莓派 4） | 四核 x86（Intel/AMD 入门即可） |
| **内存** | 2 GB RAM | 4 GB RAM |
| **存储** | 16 GB 可用空间（系统 + 桥接服务 + 日志） | 32 GB 或以上，便于保留更多日志 |
| **系统** | Windows 10/11 或 Linux（Debian/Ubuntu LTS） | 同左；选有打印机/串口驱动生态的版本 |

### 1.3 接口要求（关键）

桥接机必须能**物理连接**门店内所有需要由它驱动的设备：

| 接口类型 | 用途 | 说明 |
|----------|------|------|
| **USB** | 小票机、部分厨房打印机、扫码枪、部分钱箱 | 建议至少 4 个 USB 口（或 2 口 + 带供电的 USB Hub）；注意部分热敏打印机需 USB 直连避免供电不足。 |
| **串口 RS-232** | 老款小票机、厨房打印机、钱箱（部分型号） | 若设备是串口，需 1～2 个串口；主板无串口时可使用 USB 转串口线。 |
| **并口 LPT** | 部分钱箱（通过打印机口脉冲开箱） | 老机型才有并口；新机多为 USB 或接在小票机后级。 |
| **有线网口 Ethernet** | 与 GCP 通信、可选接网络打印机/KDS | 至少 1 个千兆网口；若打印机/KDS 为网络型，可交换机统一接入。 |

**小结**：  
- 设备多为 **USB**：重点看 USB 数量与供电。  
- 设备含 **串口/并口**：需预留串口或 USB 转串口，并口可选（视钱箱型号而定）。

### 1.4 其他建议

- **无风扇或低噪音**：若放在前台/后厨，尽量选静音或被动散热，减少灰尘与故障。
- **7×24 运行**：选工控机或商用迷你主机更稳妥；普通家用机需注意散热与电源质量。
- **品牌**：优先选与打印机/钱箱厂商有兼容性说明的型号（如商米、新大陆等提供的“推荐主机”）。

---

## 二、网络配置要求

### 2.1 与 GCP 的通信

| 项目 | 要求 |
|------|------|
| **方向** | 桥接机 **主动出站** 到 GCP（拉取任务或建立长连接）；GCP 不主动连入门店。 |
| **协议** | HTTPS（443）、若用 WebSocket 则为 WSS（443）。 |
| **DNS** | 能解析后端 API 域名（如 `api.yourdomain.com`）。 |
| **防火墙** | 出站放行 443（HTTPS/WSS）；无需在门店公网 IP 上开放入站端口。 |

### 2.2 门店内网

| 项目 | 建议 |
|------|------|
| **桥接机接入方式** | 有线以太网优先，避免 Wi‑Fi 不稳定导致断连、打印队列堆积。 |
| **IP 分配** | 建议为桥接机做 **DHCP 保留** 或 **静态 IP**，便于日后远程指定、排查。 |
| **与 iPad 关系** | iPad 与桥接机可不在同一网段；只要 iPad 能访问互联网并访问 GCP 前端即可，桥接机仅需能访问 GCP。 |

### 2.3 简单检查清单

- [ ] 桥接机可 `ping` 或 `curl` 通 GCP 后端域名。  
- [ ] 桥接机 443 出站未被公司/门店防火墙拦截。  
- [ ] 若使用代理/VPN，桥接机需能走相同出口或单独放行。

---

## 三、是否一定需要显示器？

### 3.1 结论：**不强制需要**，但分场景建议不同。

| 运行方式 | 是否需要显示器 | 说明 |
|----------|----------------|------|
| **无头运行（Headless）** | **不需要** | 桥接服务以后台/服务方式跑，不依赖图形界面；树莓派、工控机、迷你主机均可不接显示器长期运行。 |
| **初次安装与配置** | **强烈建议有** | 装系统、装驱动、配置网络、调试打印机/钱箱时，有显示器最直接；也可用远程桌面替代（见下）。 |
| **日常运维与排障** | **有则更好** | 门店有人时可直接看屏幕状态/日志；无人时依赖远程访问（见第四节）。 |

### 3.2 无显示器时的替代

- **远程桌面**：Windows 用 **RDP**，Linux 用 **VNC** 或 **RDP（xrdp）**，从运维电脑连到桥接机“相当于有屏”。  
- **SSH**：Linux 下用 SSH 进终端看日志、重启服务，无需图形界面。  
- **带外管理**：部分工控机支持 IPMI、带外卡，可远程看 console，与是否接显示器无关。

因此：**从“能否工作”角度，不接显示器也可以**；从“装机和第一次调硬件”角度，**建议至少装机阶段有显示器或可靠的远程桌面**。

---

## 四、有显示器是否更方便未来远程解决问题？

### 4.1 结论：**有显示器对远程排障有帮助，但非唯一手段；远程访问能力更关键。**

| 维度 | 有显示器 | 无显示器、有远程访问 |
|------|----------|------------------------|
| **门店现场有人时** | 可直接看桥接机屏幕上的状态/错误信息，电话里指导店员操作 | 需通过远程桌面/SSH 连进去再看，或让店员用手机拍屏（不理想） |
| **远程支持时** | 若配合远程桌面，支持人员“看到”的与有屏一致；若只有 SSH，则只能看日志与命令行 | 与有显示器时类似：有 RDP/VNC/SSH 即可远程排障，不依赖本地是否接屏 |
| **自动告警/日志** | 不影响；日志应上报到 GCP 或中心日志系统，有无本地屏都可远程分析 | 同左 |

### 4.2 建议组合（便于远程解决问题）

1. **桥接机具备远程访问能力**（比“只接一台显示器”更重要）：  
   - Windows：开启 **RDP**，防火墙放行 3389（或改端口），或通过 VPN/跳板机访问。  
   - Linux：开启 **SSH**（22），可选 **VNC/xrdp** 以便需要图形界面时使用。

2. **有条件的门店**：  
   - 接一台**小尺寸显示器**（或复用前台不常用的一台），平时可显示桥接服务状态、最后一条错误信息、网络状态；  
   - 出问题时，店员能直接看到“报错”或“离线”，方便电话里描述，也便于远程连进去后和现场画面一致。

3. **日志与监控**：  
   - 桥接服务将**日志上报到 GCP 或中心日志**（或至少写入本地文件并由另一 agent 采集）；  
   - 这样**即使没有显示器和远程桌面**，也能通过日志和告警做大部分远程排障。

### 4.3 总结

- **显示器不是必须**：桥接机可以无头 7×24 运行。  
- **有显示器**：初次装机、现场有人时看状态/报错更直观，**有利于现场与远程配合排障**。  
- **真正决定“能否远程解决问题”的**是：**远程访问（RDP/VNC/SSH）+ 日志上报/监控**；显示器是加分项，不是必要条件。

---

## 五、配置与远程排障速查表

| 项目 | 建议 |
|------|------|
| **CPU/内存** | 双核/2GB 起步，多设备建议四核/4GB |
| **接口** | 至少 4 个 USB；若有串口设备则 USB 转串口或自带串口 |
| **存储** | 16GB 可用起步，建议 32GB 便于留日志 |
| **网络** | 有线接入、出站 443 通 GCP、桥接机 IP 固定或保留 |
| **显示器** | 非必须长期接；装机/首次调设备建议有屏或远程桌面 |
| **远程排障** | 开启 RDP（Windows）或 SSH（Linux），可选 VNC；日志上报到中心更佳 |

上述要求适用于“全部硬件都接到这一台电脑”的门店桥接方案；若部分设备为网络型（直接连交换机、由桥接机通过 IP 下发指令），则桥接机侧仍以 **CPU/内存/接口/网络** 为主，显示器与远程访问建议不变。
